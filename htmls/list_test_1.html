<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!DOCTYPE html>
<html>
<head>
    <title>TEMPLATE</title>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/jspsych.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-html-keyboard-response.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-html-button-response.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-image-keyboard-response.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-image-button-response.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-html-slider-response.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-preload.js"></script>
    <script src="https://s3.amazonaws.com/visualaffect/jspsych/plugin-browser-check.js"></script>
    <link href="https://s3.amazonaws.com/visualaffect/jspsych/jspsych.css" rel="stylesheet" type="text/css"/>
<!--    <title>VAT</title>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/jspsych.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-html-keyboard-response.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-html-button-response.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-image-keyboard-response.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-image-button-response.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-html-slider-response.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-preload.js"></script>-->
<!--    <script src="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/plugin-browser-check.js"></script>-->
<!--    <link href="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/jspsych/jspsych.css" rel="stylesheet" type="text/css"/>-->
<!--    <link href="https://github.com/thcucu99/cv-project/blob/main/utils/rendering/sources/js/classification.css" rel="stylesheet" type="text/css"/>-->
</head>


<script src="https://visualaffect.s3.amazonaws.com/js/data_to_jspsych_trial_2.js"></script>


<body></body>

<script>

    // All string escapes should be here, not scattered.
    const experimental_condition = '../../Dropbox/CV_project/requests/test\sessions\list_test_1.json';
    let trial_data_sequence = [{"trial_type": "message", "html_content": "\n            <div style=\"text-align:left; background-color:white; margin:1% auto; padding:2%; border-radius:8px; border-color:black; border-width:2px; max-width: 80%\">\n\n            <h1 style=\"text-align:center\">Welcome!</h1>    \n\n            This is a scientific study being conducted by researchers at MIT to help understand the visual system. It will involve viewing images and making responses. \n\n            <ul>\n\n            <li>There are neither risks nor benefits associated with performing this study.</li>\n\n            <li>If you feel uncomfortable at any point during the study, you may leave at any time with no penalty.</li>\n\n            <li>You will remain anonymous. We may ask for nonidentifying demographic information, such as your gender identity and approximate age, to help us understand how our results relate to the population at large.</li>\n\n            <li>The information you provide will only be available to MIT and collaborating research institutions. Your data will be retained throughout the lifecycle of the research project and secured through personnel authorized by MIT information services. </li>\n\n            \n\n            </ul>\n\n            \n\n            Clicking on the <b>'Accept'</b> button below indicates that you are at least 18 years of age, and that you agree to complete this study voluntarily.\n\n            </div>\n             ", "choices": ["Accept", "Reject"]}, {"trial_type": "image_block", "stimulus_image_url_1": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_97/image_97_xxxx.png", "stimulus_image_url_2": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_97/image_97_1xxx.png", "stimulus_image_url_3": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_97/image_97_12xx.png", "stimulus_image_url_4": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_97/image_97_123x.png", "stimulus_image_url_5": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_97/image_97_1234.png", "stimulus_string": "Which corner of the image was revealed last?", "choice_strings": ["top left", "top right", "bottom left", "bottom right"], "i_correct_choice": 4}, {"trial_type": "image_block", "stimulus_image_url_1": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_96/image_96_xxxx.png", "stimulus_image_url_2": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_96/image_96_xx3x.png", "stimulus_image_url_3": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_96/image_96_xx34.png", "stimulus_image_url_4": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_96/image_96_1x34.png", "stimulus_image_url_5": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_96/image_96_1234.png", "stimulus_string": "Which corner of the image was revealed second?", "choice_strings": ["top left", "top right", "bottom left", "bottom right"], "i_correct_choice": 4}, {"trial_type": "image_block", "stimulus_image_url_1": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_95/image_95_xxxx.png", "stimulus_image_url_2": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_95/image_95_xxx4.png", "stimulus_image_url_3": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_95/image_95_xx34.png", "stimulus_image_url_4": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_95/image_95_x234.png", "stimulus_image_url_5": "https://raw.githubusercontent.com/thcucu99/cv-project/main/images/all_images/image_95/image_95_1234.png", "stimulus_string": "Which corner of the image was revealed second?", "choice_strings": ["top left", "top right", "bottom left", "bottom right"], "i_correct_choice": 3}];
    if (typeof trial_data_sequence === 'string' || trial_data_sequence instanceof String) {
        trial_data_sequence = [];
    }

    // Globals
    const session_start_time = new Date().toISOString();
    let EXTERNAL_IMAGE_REFERENCES = [];

    let jsPsych = initJsPsych({
        show_progress_bar: true,
        on_finish: function () {
            jsPsych.data.displayData();
        }
    });

    // Assemble high-level jsPsych trials
    let preload_trial = {
        type: jsPsychPreload,
        auto_preload: true,
        show_progress_bar: true,
        message: 'Loading experiment...',
        images: EXTERNAL_IMAGE_REFERENCES,
        on_finish: function () {
            console.log('Done preloading.')
        }
    }
    let browser_check = {
      type: jsPsychBrowserCheck,
      inclusion_function: (data) => {
        return data.mobile === false
      },
      exclusion_message: (data) => {
          if (data.mobile) {
              return '<p>You must use a desktop/laptop computer to participate in this experiment.</p>';
          }
      }
    };

    let turk_submission_node = {
        type: jsPsychHtmlButtonResponse,
        stimulus: '<h1>Click to submit your work.</h1>',
        choices: ['Submit'],
        trial_duration: 10000, // Wait before autosubmitting
        on_finish: function () {
            const turkInfo = jsPsych.turk.turkInfo();
            let data = jsPsych.data.get().json()

            let dataobject = {
                'trial_datastring': JSON.stringify(data),
                'session_start_time': session_start_time,
                'task_url': window.location.href,
                'experimental_condition': experimental_condition,
            }
            jsPsych.turk.submitToTurk(dataobject);
            if (turkInfo.outsideTurk === true) {
                console.log(data)
                jsPsych.data.displayData('JSON');
            }
        },
    };


    // Assemble sequence of jsPsych trials
    let experimental_jspsych_trials = [];

    for (let i_trial = 0; i_trial < trial_data_sequence.length; i_trial++) {
        const current_trial_json = trial_data_sequence[i_trial];

        let jspsych_trial = get_jspsych_trial(
            current_trial_json
        )

        // If null, that means a trial was not successfully created. Continue.
        if (jspsych_trial === null) {
            continue;
        }
        // experimental_jspsych_trials.push(create_fixation_trial());
        experimental_jspsych_trials.push(jspsych_trial);
    }

    console.log(experimental_jspsych_trials)
    if (experimental_jspsych_trials.length > 0) {
        jsPsych.run([
            browser_check,
            preload_trial,
            ...experimental_jspsych_trials,
            turk_submission_node,
        ]);

    } else {
        alert('No trials found. This is a Requestor error.');
    }


</script>
</html>
</head>
<body>

</body>
</html>